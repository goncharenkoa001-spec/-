<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ü–æ—Å—Ç –±–ª–æ–≥–∞ - –ó–ê–ë–ê–í–´ –†–ê–î–ò</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* –°—Ç–∏–ª–∏ –¥–ª—è –º–µ–¥–∏–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ */
        .media-section {
            margin: 2.5rem 0;
            padding: 1.5rem;
            background: #1a2837;
            border-radius: 10px;
            border: 1px solid #2a3b4d;
        }

        .media-section h3 {
            color: #ffffff;
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
            border-bottom: 1px solid #2a3b4d;
            padding-bottom: 0.5rem;
        }

        .media-item {
            margin-bottom: 1.5rem;
        }

        .media-item:last-child {
            margin-bottom: 0;
        }

        .media-item img {
            max-width: 100%;
            height: auto;
            border-radius: 8px;
            cursor: zoom-in;
            transition: transform 0.3s ease;
            border: 2px solid #2a3b4d;
        }

        .media-item img:hover {
            transform: scale(1.02);
        }

        .media-item video {
            max-width: 100%;
            border-radius: 8px;
            background: #000;
        }

        .media-item audio {
            width: 100%;
            margin: 0.5rem 0;
        }

        .audio-item {
            background: #17212b;
            padding: 1rem;
            border-radius: 8px;
            border: 1px solid #2a3b4d;
        }

        .media-filename {
            color: #7f91a4;
            font-size: 0.8rem;
            margin-top: 0.5rem;
            text-align: center;
        }

        .post-text-content {
            line-height: 1.6;
            margin-bottom: 2rem;
            color: #c5c5c5;
        }

        .post-text-content p {
            margin-bottom: 1rem;
        }

    </style>
</head>
<body>
    <header>
        <div class="header-content">
            <a href="index.html" class="logo">
                <img src="logo.png" alt="–õ–æ–≥–æ—Ç–∏–ø" class="logo-img">
            </a>
            <div class="header-text">
                <h1>–ó–ê–ë–ê–í–´ –†–ê–î–ò</h1>
                <p>–†–∏—Å—É–Ω–∫–∏, –∏–≥—Ä–∞ –Ω–∞ –º—É–∑—ã–∫–∞–ª—å–Ω—ã—Ö –∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç–∞—Ö –∏ –º–æ–º–µ–Ω—Ç—ã –∏–∑ –∂–∏–∑–Ω–∏.</p>
            </div>
        </div>
    </header>

    <nav>
        <a href="index.html">–í—Å–µ –ø–æ—Å—Ç—ã</a>
        <a href="gallery.html">–ì–∞–ª–µ—Ä–µ—è</a>
        <a href="about.html">–û–±–æ –º–Ω–µ</a>
    </nav>

    <main>
        <article class="post-content" id="post-content">
            <!-- –ü–æ—Å—Ç –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–µ–Ω —á–µ—Ä–µ–∑ JavaScript -->
        </article>

        <!-- –°–µ–∫—Ü–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
        <section class="comments-section" id="comments-section">
            <h3>üí¨ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏</h3>
            
            <!-- –§–æ—Ä–º–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è -->
            <div class="comment-form">
                <div class="form-group">
                    <input type="text" id="comment-author" class="form-control" placeholder="–í–∞—à–µ –∏–º—è (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ)">
                </div>
                <div class="form-group">
                    <textarea id="comment-text" class="form-control" placeholder="–í–∞—à –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π..." rows="3"></textarea>
                </div>
                <button onclick="addComment()" class="btn">üì® –û—Ç–ø—Ä–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π</button>
            </div>

            <!-- –°–ø–∏—Å–æ–∫ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ -->
            <div class="comments-list" id="comments-list">
                <!-- –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –±—É–¥—É—Ç –∑–¥–µ—Å—å -->
            </div>
        </section>
    </main>

    <footer>
        <p>t.me/cortel142</p>
    </footer>

    <script src="comments.js"></script>
    <script>
        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª–Ω–æ—ç–∫—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
        function openFullscreen(imgSrc, altText) {
            const fullscreenDiv = document.createElement('div');
            fullscreenDiv.className = 'image-fullscreen';
            fullscreenDiv.innerHTML = `
                <button class="image-fullscreen-close" onclick="closeFullscreen()">√ó</button>
                <img src="${imgSrc}" alt="${altText}">
            `;
            
            document.body.appendChild(fullscreenDiv);
            
            fullscreenDiv.addEventListener('click', function(e) {
                if (e.target === fullscreenDiv) {
                    closeFullscreen();
                }
            });
            
            document.addEventListener('keydown', function closeOnEsc(e) {
                if (e.key === 'Escape') {
                    closeFullscreen();
                    document.removeEventListener('keydown', closeOnEsc);
                }
            });
            
            document.body.style.overflow = 'hidden';
        }
        
        function closeFullscreen() {
            const fullscreen = document.querySelector('.image-fullscreen');
            if (fullscreen) {
                fullscreen.remove();
                document.body.style.overflow = '';
            }
        }

        // –ó–∞–≥—Ä—É–∑–∫–∞ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ—Å—Ç–∞ —Å –º–µ–¥–∏–∞
        const urlParams = new URLSearchParams(window.location.search);
        const postId = urlParams.get('id');
        const posts = JSON.parse(localStorage.getItem('blogPosts')) || [];
        const post = posts.find(p => p.id === postId);

        function renderMediaContent(post) {
            let mediaHTML = '';
            
            // –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ñ–æ—Ç–æ
            if (post.images && post.images.length > 0) {
                mediaHTML += '<div class="media-section">';
                mediaHTML += '<h3>üì∑ –§–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏</h3>';
                post.images.forEach((imageUrl, index) => {
                    if (imageUrl && imageUrl.trim()) {
                        mediaHTML += `
                            <div class="media-item">
                                <img src="${imageUrl}" alt="–§–æ—Ç–æ ${index + 1}" onclick="openFullscreen('${imageUrl}', '–§–æ—Ç–æ ${index + 1}')">
                            </div>
                        `;
                    }
                });
                mediaHTML += '</div>';
            }
            
            // –í–∏–¥–µ–æ
            if (post.videos && post.videos.length > 0) {
                mediaHTML += '<div class="media-section">';
                mediaHTML += '<h3>üé• –í–∏–¥–µ–æ</h3>';
                post.videos.forEach((videoUrl, index) => {
                    if (videoUrl && videoUrl.trim()) {
                        mediaHTML += `
                            <div class="media-item">
                                <video controls>
                                    <source src="${videoUrl}" type="video/mp4">
                                    –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –≤–∏–¥–µ–æ.
                                </video>
                                <div class="media-filename">${videoUrl.split('/').pop()}</div>
                            </div>
                        `;
                    }
                });
                mediaHTML += '</div>';
            }
            
            // –ê—É–¥–∏–æ
            if (post.audios && post.audios.length > 0) {
                mediaHTML += '<div class="media-section">';
                mediaHTML += '<h3>üéµ –ê—É–¥–∏–æ</h3>';
                post.audios.forEach((audioUrl, index) => {
                    if (audioUrl && audioUrl.trim()) {
                        const filename = audioUrl.split('/').pop();
                        mediaHTML += `
                            <div class="media-item audio-item">
                                <audio controls>
                                    <source src="${audioUrl}" type="audio/mpeg">
                                    –í–∞—à –±—Ä–∞—É–∑–µ—Ä –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –∞—É–¥–∏–æ.
                                </audio>
                                <div class="media-filename">${filename}</div>
                            </div>
                        `;
                    }
                });
                mediaHTML += '</div>';
            }
            
            return mediaHTML;
        }

        // –§—É–Ω–∫—Ü–∏–∏ –¥–ª—è –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤
        function addComment() {
            const author = document.getElementById('comment-author').value;
            const text = document.getElementById('comment-text').value;
            const postId = new URLSearchParams(window.location.search).get('id');

            if (!text.trim()) {
                alert('–í–≤–µ–¥–∏—Ç–µ —Ç–µ–∫—Å—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è');
                return;
            }

            const comment = commentsSystem.addComment(postId, author, text);
            renderComments();
            
            // –û—á–∏—â–∞–µ–º —Ñ–æ—Ä–º—É
            document.getElementById('comment-text').value = '';
            if (!author) {
                document.getElementById('comment-author').value = '';
            }
            
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ
            showCommentNotification('–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –¥–æ–±–∞–≤–ª–µ–Ω!');
        }

        function renderComments() {
            const postId = new URLSearchParams(window.location.search).get('id');
            const comments = commentsSystem.getComments(postId);
            const commentsList = document.getElementById('comments-list');
            
            if (comments.length === 0) {
                commentsList.innerHTML = '<div class="no-comments">–ü–æ–∫–∞ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤. –ë—É–¥—å—Ç–µ –ø–µ—Ä–≤—ã–º!</div>';
                return;
            }
            
            commentsList.innerHTML = comments.map(comment => `
                <div class="comment-item">
                    <div class="comment-header">
                        <span class="comment-author">${comment.author}</span>
                        <span class="comment-date">${comment.date}</span>
                    </div>
                    <p class="comment-text">${comment.text}</p>
                </div>
            `).join('');
        }

        function showCommentNotification(message) {
            const notification = document.createElement('div');
            notification.style.cssText = `
                position: fixed;
                top: 20px;
                right: 20px;
                background: #27ae60;
                color: white;
                padding: 1rem 1.5rem;
                border-radius: 6px;
                z-index: 10000;
                animation: slideIn 0.3s ease;
            `;
            notification.textContent = message;
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 3000);
        }

        if (post) {
            const mediaContent = renderMediaContent(post);
            document.getElementById('post-content').innerHTML = `
                <a href="index.html" class="back-link">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –ø–æ—Å—Ç–æ–≤</a>
                <h1>${post.title}</h1>
                <p class="post-date">–û–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ: ${post.date}</p>
                <div class="post-text-content">
                    ${post.content.replace(/\n/g, '<br>')}
                </div>
                ${mediaContent}
            `;
            document.title = `${post.title} - –ó–ê–ë–ê–í–´ –†–ê–î–ò`;
        } else {
            document.getElementById('post-content').innerHTML = `
                <a href="index.html" class="back-link">‚Üê –ù–∞–∑–∞–¥ –∫ —Å–ø–∏—Å–∫—É –ø–æ—Å—Ç–æ–≤</a>
                <h1>–ü–æ—Å—Ç –Ω–µ –Ω–∞–π–¥–µ–Ω</h1>
                <p>–ó–∞–ø—Ä–æ—à–µ–Ω–Ω—ã–π –ø–æ—Å—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏–ª–∏ –±—ã–ª —É–¥–∞–ª–µ–Ω.</p>
            `;
        }

        // –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        document.addEventListener('DOMContentLoaded', function() {
            renderComments();
            
            // –î–æ–±–∞–≤–ª—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –¥–ª—è –∫–∞—Ä—Ç–∏–Ω–æ–∫ –≤ –ø–æ—Å—Ç–µ
            const postImages = document.querySelectorAll('.media-item img');
            postImages.forEach(img => {
                img.style.cursor = 'zoom-in';
                img.addEventListener('click', function() {
                    openFullscreen(this.src, this.alt);
                });
            });
        });
    </script>

    <script>
        function updateHeaderHeights() {
            const header = document.querySelector('header');
            const nav = document.querySelector('nav');
            const main = document.querySelector('main');
            
            if (header && nav && main) {
                const headerHeight = header.offsetHeight;
                const navHeight = nav.offsetHeight;
                
                document.body.style.paddingTop = headerHeight + 'px';
                nav.style.top = headerHeight + 'px';
                main.style.marginTop = navHeight + 20 + 'px';
            }
        }
        
        document.addEventListener('DOMContentLoaded', function() {
            updateHeaderHeights();
            window.addEventListener('resize', updateHeaderHeights);
            setTimeout(updateHeaderHeights, 200);
        });
    </script>
</body>
</html>